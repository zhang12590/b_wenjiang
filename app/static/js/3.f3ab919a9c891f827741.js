webpackJsonp([3],{BJmi:function(e,t){},H8v3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),s=n.n(a),r=n("mvHQ"),o=n.n(r),c=n("exGp"),i=n.n(c),l=n("M4fF"),p=n.n(l),u={name:"call",data:function(){return{userIfon:{},marqueeText:"",initialMarqueeText:"",todayList:[{name:"当前窗口号",val:localStorage.window},{name:"当前办理号",val:""},{name:"等待人数",val:""},{name:"当天办理总数",val:""}],applyName:"",openApplyName:!0,applyObject:"",openApplyObject:!0,nextPerson:{name:"下一位",icon:"user",disabled:!1},reCall:{name:"重新呼叫",icon:"horn",disabled:!0},pause:{name:"暂停",icon:"pause",disabled:!1},isPause:!0,move:{name:"转号",icon:"move",disabled:!0},Acceptance:{name:"受理",icon:"Acceptance",disabled:!0},unAcceptance:{name:"未受理",icon:"unAcceptance",disabled:!0},personInfo:{}}},computed:{openAcceptance:function(){return""!==this.applyName.replace(/(^\s*)|(\s*$)/g,"")&&""!==this.applyObject.replace(/(^\s*)|(\s*$)/g,"")}},watch:{openAcceptance:function(e){this.Acceptance.disabled=!e}},created:function(){sessionStorage.userInfo?(this.userIfon=JSON.parse(sessionStorage.userInfo),this.marqueeText="欢迎 <b>"+this.userIfon.name+"</b> 登录系统",this.initialMarqueeText=this.marqueeText):console.log("call-无用户信息")},methods:{nextPersonFn:p.a.debounce(function(){this.callNextPersonFn()},1e3),reCallFn:p.a.debounce(function(){this.reCallHandle()},1e3),pauseFn:p.a.debounce(function(){if(this.isPause){this.pause={name:"开始",icon:"start",disabled:!1},this.pauseHandleFn();this.distributeDisabled([!0,!0,!1,!0,!0,!0],this)}else{this.pause={name:"暂停",icon:"pause",disabled:!1},this.startHandleFn();this.distributeDisabled([!1,!0,!1,!0,!0,!0],this)}this.isPause=!this.isPause},5),moveFn:p.a.debounce(function(){var e=this,t=JSON.parse(sessionStorage.reference);console.log(t),console.log(this.userIfon),"3"===t.radio?""===t.curTheme?this.$alert("请选择转号的主题","提示",{confirmButtonText:"确定",callback:function(e){}}):""===t.curMatter?this.$alert("请选择转号的事项","提示",{confirmButtonText:"确定",callback:function(e){}}):t.curTheme===this.userIfon.subject?this.$alert("转号的主题与工作人员所在主题一致，请修改","提示",{confirmButtonText:"确定",callback:function(e){}}):this.$confirm("事件将转移到"+t.curTheme+"-"+t.curMatter,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.moveHandleFn(t)}).catch(function(){}):this.$alert("请选择转号功能","提示",{confirmButtonText:"确定",callback:function(e){}})},600),AcceptanceFn:p.a.debounce(function(){var e=this,t=JSON.parse(sessionStorage.reference);"2"===t.radio?t.curTheme?t.curMatter?this.userIfon.subject===t.curTheme?this.$confirm("请确定当前事项合格","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.personInfo.subject=t.curTheme,e.personInfo.item=t.curMatter,e.personInfo.deal_status="Y",e.AcceptanceHandleFn()}).catch(function(){console.log("取消受理")}):this.myAlert("修改的主题与工作人员所在主题不一致，请修改","提示"):this.myAlert("未选择需修改的事项","提示"):this.myAlert("未选择需修改的主题","提示"):this.$confirm("请确定当前事项合格","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.personInfo.deal_status="Y",e.AcceptanceHandleFn()}).catch(function(){console.log("取消受理")})},600),unAcceptanceFn:p.a.debounce(function(){var e=this,t=JSON.parse(sessionStorage.reference);"2"===t.radio?t.curTheme?t.curMatter?this.userIfon.subject===t.curTheme?this.$confirm("请确定当前事项不合格","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.personInfo.subject=t.curTheme,e.personInfo.item=t.curMatter,e.personInfo.deal_status="N",e.AcceptanceHandleFn()}).catch(function(){console.log("取消未受理")}):this.myAlert("修改的主题与工作人员所在主题不一致，请修改","提示"):this.myAlert("未选择需修改的事项","提示"):this.myAlert("未选择需修改的主题","提示"):this.$confirm("请确定当前事项不合格","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.personInfo.deal_status="N",e.AcceptanceHandleFn()}).catch(function(){console.log("取消未受理")})},600),callNextPersonFn:function(){var e=this;return i()(s.a.mark(function t(){var n,a,r,c,i,l,p;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.userIfon,t.next=4,e.$api.unsplash.getNextPerson(n);case 4:a=t.sent,console.log(a),"0"===a.errno?(e.personInfo=a.data.business,e.personInfo.user_id=e.userIfon.user_id,e.personInfo.lingpai=localStorage.lingpai,e.todayList[1].val=e.personInfo.number,e.todayList[2].val=a.data.wait,e.todayList[3].val=a.data.called,e.applyName="",e.applyObject="",e.openApplyName=!1,e.openApplyObject=!1,e.personInfo.cometimes+1>=3?e.marqueeText="流水号:<b>"+e.personInfo.water_num+'</b>，本次为<b style="color:red;">第'+(e.personInfo.cometimes+1)+"次</b>来办理<b>"+e.personInfo.item+'</b>，<b style="color:red;">请认真对待每位群众</b>':e.marqueeText="流水号:<b>"+e.personInfo.water_num+"</b>，本次为<b>第"+(e.personInfo.cometimes+1)+"次</b>来办理<b>"+e.personInfo.item+'</b>，<b style="">请认真对待每位群众</b>',e.getElement(e.personInfo.item),r=[!0,!1,!0,!1,!0,!1],e.distributeDisabled(r,e),(c=JSON.parse(sessionStorage.reference)).filteredList=[],sessionStorage.reference=o()(c)):"4004"===a.errno?(e.todayList[1].val="",e.notifyFn("提示",a.errmsg),i=[!1,!0,!1,!0,!0,!0],e.distributeDisabled(i,e)):(e.todayList[1].val="",e.notifyFn("提示",a.errmsg),l=[!1,!0,!1,!0,!0,!0],e.distributeDisabled(l,e)),t.next=15;break;case 9:t.prev=9,t.t0=t.catch(0),e.notifyFn("提示","服务器错误"),p=[!1,!0,!1,!0,!0,!0],e.distributeDisabled(p,e),console.log(t.t0);case 15:case"end":return t.stop()}},t,e,[[0,9]])}))()},getElement:function(e){var t=this;return i()(s.a.mark(function n(){var a,r,c,i,l,p;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a={item:e},n.next=4,t.$api.unsplash.postElements(a);case 4:if("0"===(r=n.sent).errno){for(c=r.data,i=[],l=0;l<c.length;l++)c[l].index=l+1,i.push(c[l].id);p={radio:"1",curTheme:t.personInfo.subject,curMatter:t.personInfo.item,allID:i,selectionElementId:t.personInfo.last_reviews?t.personInfo.last_reviews.split("-"):[]},sessionStorage.reference=o()(p)}else t.notifyFn("提示",r.errmsg);n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),t.notifyFn("提示","服务器错误"),console.log(n.t0);case 12:case"end":return n.stop()}},n,t,[[0,8]])}))()},reCallHandle:function(){var e=this;return i()(s.a.mark(function t(){var n,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={water_num:e.personInfo.water_num,lingpai:localStorage.lingpai,user_id:sessionStorage.user_id},t.next=4,e.$api.unsplash.postReCall(n);case 4:"0"===(a=t.sent).errno?e.notifyFn("提示","正在重呼","success"):e.notifyFn("提示",a.errmsg),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),e.notifyFn("提示","服务器错误"),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},pauseHandleFn:function(){var e=this;return i()(s.a.mark(function t(){var n,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={lingpai:localStorage.lingpai,user_id:sessionStorage.user_id},t.next=4,e.$api.unsplash.postPause(n);case 4:"0"===(a=t.sent).errno?e.afterDealed(e):e.notifyFn("提示",a.errmsg),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),e.notifyFn("提示","服务器错误"),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},startHandleFn:function(){var e=this;return i()(s.a.mark(function t(){var n,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={lingpai:localStorage.lingpai,user_id:sessionStorage.user_id},t.next=4,e.$api.unsplash.postStart(n);case 4:"0"===(a=t.sent).errno?e.afterDealed(e):e.notifyFn("提示",a.errmsg),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),e.notifyFn("提示","服务器错误"),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},moveHandleFn:function(e){var t=this;return i()(s.a.mark(function n(){var a,r,o;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,(a=t.personInfo).subject=e.curTheme,a.item=e.curMatter,console.log(t.personInfo),n.next=7,t.$api.unsplash.postMove(a);case 7:r=n.sent,console.log(r),"0"===r.errno?(t.afterDealed(t),o=[!1,!0,!1,!0,!0,!0],t.distributeDisabled(o,t),t.marqueeText=t.initialMarqueeText):t.notifyFn("提示",r.errmsg),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),t.notifyFn("提示","服务器错误"),console.log(n.t0);case 16:case"end":return n.stop()}},n,t,[[0,12]])}))()},AcceptanceHandleFn:function(){var e=this;return i()(s.a.mark(function t(){var n,a,r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=JSON.parse(sessionStorage.reference),e.personInfo.reviews=n.selectionElementId.join("-"),e.personInfo.p_name=e.applyName.replace(/(^\s*)|(\s*$)/g,""),e.personInfo.p_project=e.applyObject.replace(/(^\s*)|(\s*$)/g,""),a=e.personInfo,console.log(14,e.personInfo),t.next=9,e.$api.unsplash.postAcceptance(a);case 9:r=t.sent,console.log(r),"0"===r.errno?(e.afterDealed(e),o=[!1,!0,!1,!0,!0,!0],e.distributeDisabled(o,e),e.marqueeText=e.initialMarqueeText):e.notifyFn("提示",r.errmsg),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),e.notifyFn("提示","服务器错误"),console.log(t.t0);case 18:case"end":return t.stop()}},t,e,[[0,14]])}))()},notifyFn:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warning";this.$notify({title:e,message:t,type:n,dangerouslyUseHTMLString:!0,duration:5e3,position:"top-right"})},myAlert:function(e,t){this.$alert(e,t,{confirmButtonText:"确定",callback:function(e){}})},distributeDisabled:function(e,t){t.nextPerson.disabled=e[0],t.reCall.disabled=e[1],t.pause.disabled=e[2],t.move.disabled=e[3],t.Acceptance.disabled=e[4],t.unAcceptance.disabled=e[5]},afterDealed:function(e){e.todayList[1].val="",e.applyName="",e.openApplyName=!0,e.applyObject="",e.openApplyObject=!0}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"call"},[n("div",[n("marquee",{attrs:{behavior:"alternate",scrollamount:"3"},domProps:{innerHTML:e._s(e.marqueeText)}})],1),e._v(" "),n("div",{staticClass:"inputWarp"},[n("el-row",{attrs:{gutter:20}},[e._l(e.todayList,function(t,a){return n("el-col",{key:a,staticClass:"itemTodayIfon",attrs:{span:12}},[n("el-input",{attrs:{placeholder:"",disabled:""},model:{value:t.val,callback:function(n){e.$set(t,"val",n)},expression:"item.val"}},[n("template",{slot:"prepend"},[e._v(e._s(t.name))])],2)],1)}),e._v(" "),n("el-col",{staticClass:"itemTodayIfon",attrs:{span:12}},[n("el-input",{attrs:{placeholder:"输入申请方",disabled:e.openApplyName},model:{value:e.applyName,callback:function(t){e.applyName=t},expression:"applyName"}},[n("template",{slot:"prepend"},[e._v("申请方")])],2)],1),e._v(" "),n("el-col",{staticClass:"itemTodayIfon",attrs:{span:12}},[n("el-input",{attrs:{placeholder:"输入申请项目",disabled:e.openApplyObject},model:{value:e.applyObject,callback:function(t){e.applyObject=t},expression:"applyObject"}},[n("template",{slot:"prepend"},[e._v("申请项目")])],2)],1)],2)],1),e._v(" "),n("div",{staticClass:"btnWarp"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{staticClass:"itemBtnWarp",attrs:{span:8}},[n("el-button",{staticClass:"itemBtn",attrs:{type:"success",disabled:e.nextPerson.disabled},on:{click:e.nextPersonFn}},[n("svg-icon",{staticStyle:{width:"30px",height:"30px"},attrs:{"icon-class":e.nextPerson.icon}}),e._v(e._s(e.nextPerson.name))],1)],1),e._v(" "),n("el-col",{staticClass:"itemBtnWarp",attrs:{span:8}},[n("el-button",{staticClass:"itemBtn",attrs:{type:"warning",disabled:e.reCall.disabled},on:{click:e.reCallFn}},[n("svg-icon",{staticStyle:{width:"30px",height:"30px"},attrs:{"icon-class":e.reCall.icon}}),e._v(e._s(e.reCall.name))],1)],1),e._v(" "),n("el-col",{staticClass:"itemBtnWarp",attrs:{span:8}},[n("el-button",{staticClass:"itemBtn",attrs:{type:"danger",disabled:e.pause.disabled},on:{click:e.pauseFn}},[n("svg-icon",{staticStyle:{width:"30px",height:"30px"},attrs:{"icon-class":e.pause.icon}}),e._v(e._s(e.pause.name))],1)],1),e._v(" "),n("el-col",{staticClass:"itemBtnWarp",attrs:{span:8}},[n("el-button",{staticClass:"itemBtn",attrs:{type:"danger",disabled:e.move.disabled},on:{click:e.moveFn}},[n("svg-icon",{staticStyle:{width:"30px",height:"30px"},attrs:{"icon-class":e.move.icon}}),e._v(e._s(e.move.name))],1)],1),e._v(" "),n("el-col",{staticClass:"itemBtnWarp",attrs:{span:8}},[n("el-button",{staticClass:"itemBtn",attrs:{type:"info",disabled:!e.openAcceptance},on:{click:e.AcceptanceFn}},[n("svg-icon",{staticStyle:{width:"30px",height:"30px"},attrs:{"icon-class":e.Acceptance.icon}}),e._v(e._s(e.Acceptance.name))],1)],1),e._v(" "),n("el-col",{staticClass:"itemBtnWarp",attrs:{span:8}},[n("el-button",{staticClass:"itemBtn",attrs:{type:"primary",disabled:e.unAcceptance.disabled},on:{click:e.unAcceptanceFn}},[n("svg-icon",{staticStyle:{width:"30px",height:"30px"},attrs:{"icon-class":e.unAcceptance.icon}}),e._v(e._s(e.unAcceptance.name))],1)],1)],1)],1)])},staticRenderFns:[]};var f=n("VU/8")(u,d,!1,function(e){n("BJmi"),n("PbNs")},"data-v-62edf408",null);t.default=f.exports},PbNs:function(e,t){}});
//# sourceMappingURL=3.f3ab919a9c891f827741.js.map