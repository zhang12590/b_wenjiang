webpackJsonp([14],{rBDB:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l("Xxa5"),i=l.n(n),s=l("mvHQ"),r=l.n(s),o=l("exGp"),a=l.n(o),c={name:"ServiceElement",data:function(){return{userIfon:{},curElementList:[],multipleSelection:[],curSeleckRow:[],selectionElementId:[],curMatter:"",allID:[],filtersList:[{text:"接件",value:"接件"},{text:"经办人",value:"经办人"},{text:"踏勘中心",value:"踏勘中心"}],filteredList:[]}},watch:{},created:function(){sessionStorage.userInfo?this.userIfon=JSON.parse(sessionStorage.userInfo):console.log("call-无用户信息");if(sessionStorage.reference){var e=JSON.parse(sessionStorage.reference);this.curMatter=e.curMatter,this.selectionElementId=e.selectionElementId,this.filteredList=e.filteredList,e.curTheme?e.curMatter?this.getElement():this.$alert("未选择事项","警告",{confirmButtonText:"确定",callback:function(e){}}):this.$alert("未选择主题","警告",{confirmButtonText:"确定",callback:function(e){}})}},mounted:function(){},updated:function(){console.log(12321);var e=[];this.curSeleckRow=[],this.toggleSelection(e);for(var t=0;t<this.curElementList.length;t++)this.selectionElementId.indexOf(""+this.curElementList[t].id)>-1&&(e.push(this.curElementList[t]),this.curSeleckRow.push(this.curElementList[t].index));this.toggleSelection(e)},methods:{getElement:function(){var e=this;return a()(i.a.mark(function t(){var l,n,s,o,a,c,u;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l={item:e.curMatter},t.next=4,e.$api.unsplash.postElements(l);case 4:if("0"===(n=t.sent).errno){for(s=n.data,e.allID=[],o=0;o<s.length;o++)s[o].index=o+1,e.allID.push(s[o].id);if(s[0].process.length)for(a=s[0].process.split("-"),e.filtersList=[],c=0;c<a.length;c++)e.filtersList.push({text:a[c],value:a[c]});else e.filtersList=[];e.curElementList=s,(u=JSON.parse(sessionStorage.reference)).allID=e.allID,sessionStorage.reference=r()(u),console.log(s)}else e.notifyFn("提示",n.errmsg);t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),e.notifyFn("提示","服务器错误"),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},reviewClickFn:function(e){var t=this;return a()(i.a.mark(function l(){var n,s;return i.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,n=e,l.next=4,t.$api.unsplash.reviewClick(n);case 4:s=l.sent,console.log(s),"0"===s.errno||t.notifyFn("提示",s.errmsg),l.next=13;break;case 9:l.prev=9,l.t0=l.catch(0),t.notifyFn("提示","服务器错误"),console.log(l.t0);case 13:case"end":return l.stop()}},l,t,[[0,9]])}))()},headerCellStyle:function(e){e.row,e.column;var t=e.rowIndex;e.columnIndex;if(t>-1)return{"text-align":"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex;var t=e.columnIndex;return 0===t||1===t?{"text-align":"center"}:1===t?{}:void 0},handleSelectionChange:function(e,t){this.multipleSelection=e,this.curSeleckRow=[],this.selectionElementId=[];for(var l=0;l<this.multipleSelection.length;l++)this.curSeleckRow.push(this.multipleSelection[l].index),this.selectionElementId.push(""+this.multipleSelection[l].id);var n=JSON.parse(sessionStorage.reference);if(n.selectionElementId=this.selectionElementId,n.allID=this.allID,sessionStorage.reference=r()(n),"大厅"===this.userIfon.role){var i={itemreviews:this.curElementList,current_click:t.id,reviewsclick:this.selectionElementId.join("-"),lingpai:localStorage.lingpai,user_id:sessionStorage.user_id};console.log(12,i),this.reviewClickFn(i)}},selectAllFn:function(e){this.multipleSelection=e,this.curSeleckRow=[],this.selectionElementId=[];for(var t=0;t<this.multipleSelection.length;t++)this.curSeleckRow.push(this.multipleSelection[t].index),this.selectionElementId.push(""+this.multipleSelection[t].id);var l=JSON.parse(sessionStorage.reference);if(l.selectionElementId=this.selectionElementId,l.allID=this.allID,sessionStorage.reference=r()(l),"大厅"===this.userIfon.role){var n={itemreviews:this.curElementList,current_click:Math.min.apply(null,this.allID),reviewsclick:this.selectionElementId.join("-"),lingpai:localStorage.lingpai,user_id:sessionStorage.user_id};console.log(13,n),this.reviewClickFn(n)}},tableRowClassName:function(e){var t=e.row;e.rowIndex;return this.selectionElementId.indexOf(""+t.id)>-1?"warning-row-element":""},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},filterTag:function(e,t){return t.steps.indexOf(e)>-1},filterChangeFn:function(e){var t=JSON.parse(sessionStorage.reference);t.filteredList=e.filterTag,sessionStorage.reference=r()(t)},notifyFn:function(e,t){this.$notify({title:e,message:t,type:"warning",dangerouslyUseHTMLString:!0,duration:5e3,position:"top-right"})}}},u={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{attrs:{id:"elementT"}},[l("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.curElementList,"tooltip-effect":"dark","row-class-name":e.tableRowClassName,"header-cell-style":e.headerCellStyle,"cell-style":e.cellStyle},on:{select:e.handleSelectionChange,"select-all":e.selectAllFn,"filter-change":e.filterChangeFn}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),l("el-table-column",{attrs:{prop:"index",label:"序号",width:"80",sortable:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"材料清单",width:"320"}}),e._v(" "),l("el-table-column",{attrs:{prop:"require",label:"材料准备要求",width:"200"}}),e._v(" "),l("el-table-column",{attrs:{prop:"permit",label:"审查要点","min-width":"300"}}),e._v(" "),l("el-table-column",{attrs:{prop:"steps",label:"需查看的流程",width:"280","column-key":"filterTag",align:"center",filters:e.filtersList,"filter-method":e.filterTag,"filter-placement":"bottom-end","filtered-value":e.filteredList},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-tag",{directives:[{name:"show",rawName:"v-show",value:t.row.steps.length,expression:"scope.row.steps.length"}],attrs:{size:"medium"}},[e._v(e._s(t.row.steps.join("-")))])]}}])})],1)],1)},staticRenderFns:[]};var h=l("VU/8")(c,u,!1,function(e){l("sDwD")},null,null);t.default=h.exports},sDwD:function(e,t){}});
//# sourceMappingURL=14.6cf4d113f40ca21f50f4.js.map