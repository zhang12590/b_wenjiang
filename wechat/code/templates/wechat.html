<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <meta name="format-detection" content="telephone=no">
    <meta name="keywords" content="微信,WeUI,示例,案例">
    <meta name="description" content="WeUI 为微信 Web 服务量身设计">
    <title>WeUI 应用案例</title>
    <script src="https://cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
    <link rel="stylesheet" href="https://res.wx.qq.com/open/libs/weui/1.1.3/weui.min.css">
    <script type="text/javascript" src="https://res.wx.qq.com/open/libs/weuijs/1.1.4/weui.min.js"></script>
</head>
<body>
    <form id="form">
        <div class="weui-cells_title">预约</div>
        <div class="weui-cell">
            <div class="weui-cell_hd">
                <label class="weui-label">电话</label>
            </div>
            <div class="weui-cell_bd">
                <input type="text" name="phone" class="weui-input" required placeholder="请输入你的电话号码" id="phone" emptyTips="信息不完整">
            </div>
        </div>
        <div class="weui-cell">
            <div class="weui-cell_hd">
                <label class="weui-label">身份证</label>
            </div>
            <div class="weui-cell_bd">
                <input type="text" name="idcard" class="weui-input" required placeholder="请输入身份证" id="idcard" emptyTips="信息不完整">
            </div>
        </div>
        <div class="weui-cell weui-cell_select weui-cell_select-after">
            <div class="weui-cell__hd">
                <label for="" class="weui-label">性别</label>
            </div>
            <div class="weui-cell__bd">
                <select class="weui-select" name="select1" id="select1">
                    <option value="1">男</option>
                    <option value="2">女</option>
                </select>
            </div>
        </div>
        <div class="weui-cell">
            <div class="weui-cell_hd">
                <label for="" class="weui-label">业务</label>
            </div>
            <div class="weui-cell_bd">
                <input type="text" name="task" id="picktask" class="weui-input" required placeholder="请选择业务" emptyTips="信息不完整">
            </div>
        </div>
        <div class="weui-cell">
            <div class="weui-cell_hd">
                <label for="" class="weui-label">日期</label>
            </div>
            <div class="weui-cell_bd">
                <input type="text" name="date" id="pickdate" class="weui-input" required placeholder="请选择日期" emptyTips="信息不完整">
            </div>
        </div>
        <div class="weui-cell">
            <div class="weui-cell_hd">
                <label for="" class="weui-label">时间</label>
            </div>
            <div class="weui-cell_bd">
                <input type="text" name="time" id="picktime" class="weui-input" required placeholder="请选择时间" emptyTips="信息不完整">
            </div>
        </div>
        <a href="javascript:;" class="weui-btn weui-btn_primary" id="submit">提交</a>
    </form>
    <script type="text/javascript">
        $('#picktask').on('click', function(){
            weui.picker([
            {
                label: '飞机票',
                value: 0,
                children: [
                    {
                        label: '经济舱',
                        value: 1
                    },
                    {
                        label: '商务舱',
                        value: 2
                    }
                ]
            },
            {
                label: '火车票',
                value: 1,
                children: [
                    {
                        label: '卧铺',
                        value: 1,
                        disabled: true // 不可用
                    },
                    {
                        label: '坐票',
                        value: 2
                    },
                    {
                        label: '站票',
                        value: 3
                    }
                ]
            },
            {
                label: '汽车票',
                value: 3,
                children: [
                    {
                        label: '快班',
                        value: 1
                    },
                    {
                        label: '普通',
                        value: 2
                    }
                ]
            }
            ], {
               defaultValue: [1, 3],
               onConfirm: function (result) {
                   $("#picktask").val(result[0].label+result[1].label);
               },
            });
        });
        $("#pickdate").on('click', function(){
            weui.datePicker({
                 start: new Date(), // 从今天开始
                 end: 2030,
                 cron: '* * 1,2,3,4,5',  // 每逢周日、周六
                 onConfirm: function(result){
                     $("#pickdate").val(result[0].label+result[1].label+result[2].label);
                 },
             });
        });
        $("#picktime").on('click', function(){
            weui.picker([
            {
                label: '飞机票',
                value: 0,
                children: [
                    {
                        label: '经济舱',
                        value: 1
                    },
                    {
                        label: '商务舱',
                        value: 2
                    }
                ]
            },
            {
                label: '火车票',
                value: 1,
                children: [
                    {
                        label: '卧铺',
                        value: 1,
                        disabled: true // 不可用
                    },
                    {
                        label: '坐票',
                        value: 2
                    },
                    {
                        label: '站票',
                        value: 3
                    }
                ]
            },
            {
                label: '汽车票',
                value: 3,
                children: [
                    {
                        label: '快班',
                        value: 1
                    },
                    {
                        label: '普通',
                        value: 2
                    }
                ]
            }
            ], {
               defaultValue: [1, 3],
               onConfirm: function (result) {
                   $("#picktime").val(result[0].label+result[1].label);
               },
            });
        });
        $("#submit").on('click', function(){
            weui.form.validate('#form', function (error) {
                if (!error) {
                    var loading = weui.loading('提交中...');
                    var data = {phone:$("#phone").val(),
                                idcard:$("#idcard").val(),
                                sex:$("#select1").val(),
                                task:$("#picktask").val(),
                                date:$("#pickdate").val(),
                                time:$("#picktime").val()};
                    console.log(data);
                    $.ajax({
                        url:"register",
                        data: data,
                        dataType: "json",
                        success: function(data){
                            console.log(data);
                            loading.hide();
                            weui.toast('提交成功', 3000);
                            setTimeout(window.location.href="success",1500);
                        },
                    });
                    <!--setTimeout(function () {-->
                        <!--loading.hide();-->
                        <!--weui.toast('提交成功', 3000);-->
                    <!--}, 1500);-->
                }
                // return true; // 当return true时，不会显示错误
            });
        });
    </script>
</body>

</html>
